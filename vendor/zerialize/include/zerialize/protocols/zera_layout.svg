<svg xmlns="http://www.w3.org/2000/svg" viewBox="-24.75 -27.166 969.5 531.916" width="969.5" height="531.916">
  <rect x="-24.75" y="-27.166" width="969.5" height="531.916" fill="white" />
  <style>
    .mono { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; }
    .title { font-size: 18px; font-weight: 700; fill: #111827; }
    .sub { font-size: 12px; fill: #374151; }
    .muted { fill: #6b7280; }
    .card { fill: #ffffff; stroke: #111827; stroke-width: 1.5; }
    .bar { fill: #ffffff; stroke: #111827; stroke-width: 1.5; }
    .seg-h { fill: #e0f2fe; stroke: #111827; stroke-width: 1.2; }
    .seg-e { fill: #dcfce7; stroke: #111827; stroke-width: 1.2; }
    .seg-p { fill: #fef9c3; stroke: #111827; stroke-width: 1.2; }
    .seg-a { fill: #ede9fe; stroke: #111827; stroke-width: 1.2; }
    .note { font-size: 12px; fill: #111827; }
    .arrow { stroke: #111827; stroke-width: 1.4; fill: none; marker-end: url(#m); }
  </style>
  <defs>
    <marker id="m" viewBox="0 0 10 10" refX="8.5" refY="5" markerWidth="7" markerHeight="7" orient="auto-start-reverse">
      <path d="M 0 0 L 10 5 L 0 10 z" fill="#111827" />
    </marker>
  </defs>
  <text class="title" font-family="ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial" y="10">ZERA v1: Envelope + Arena (single contiguous buffer)</text>
  <text class="sub muted" y="22" font-family="ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial">Layout: [Header][Envelope][Envelope→Arena Pad][Arena]. Arena allocations are individually aligned.</text>
  <g transform="translate(0, 44)">
    <rect class="bar" x="0" y="0" width="920" height="66" rx="12" ry="12" />
    <rect class="seg-h" x="10" y="10" width="160" height="46" rx="10" ry="10" />
    <rect class="seg-e" x="180" y="10" width="380" height="46" rx="10" ry="10" />
    <rect class="seg-p" x="570" y="10" width="90" height="46" rx="10" ry="10" />
    <rect class="seg-a" x="670" y="10" width="240" height="46" rx="10" ry="10" />
    <text class="mono" x="26" y="38" style="font-size:13px;" font-family="ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial">Header (20 B)</text>
    <text class="mono" x="310" y="38" style="font-size:13px;" font-family="ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial">Envelope (env_size)</text>
    <text class="mono" x="593" y="38" style="font-size:13px;" font-family="ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial">Pad</text>
    <text class="mono" x="744" y="38" style="font-size:13px;" font-family="ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial">Arena (bytes)</text>
    <text class="sub muted" x="10" y="86" font-family="ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial">buffer start →</text>
    <text class="sub muted" x="858" y="86" font-family="ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial">… end</text>
  </g>
  <g transform="translate(0, 140)">
    <rect class="card" x="0" y="0" width="445" height="170" rx="12" ry="12" />
    <text class="title" x="18" y="28" style="font-size:16px;" font-family="ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial">Header fields (20 B)</text>
    <text class="mono" x="18" y="56" style="font-size:12px;" font-family="ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial">u32 magic   = 'ZENV'</text>
    <text class="mono" x="18" y="76" style="font-size:12px;" font-family="ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial">u16 version = 1</text>
    <text class="mono" x="18" y="96" style="font-size:12px;" font-family="ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial">u16 flags   (bit0 = little-endian)</text>
    <text class="mono" x="18" y="116" style="font-size:12px;" font-family="ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial">u32 root_ofs  (from envelope start)</text>
    <text class="mono" x="18" y="136" style="font-size:12px;" font-family="ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial">u32 env_size  (bytes)</text>
    <text class="mono" x="18" y="156" style="font-size:12px;" font-family="ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial">u32 arena_ofs (from buffer start, 16-aligned)</text>
    <rect class="card" x="475" y="0" width="445" height="170" rx="12" ry="12" />
    <text class="title" x="493" y="28" style="font-size:16px;" font-family="ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial">What lives where</text>
    <rect class="seg-e" x="493" y="44" width="190" height="46" rx="10" ry="10" />
    <text class="mono" x="507" y="72" style="font-size:12px;" font-family="ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial">Envelope</text>
    <text class="sub muted" x="507" y="90" font-family="ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial">ValueRef16, arrays, objects, shapes</text>
    <rect class="seg-a" x="710" y="44" width="190" height="46" rx="10" ry="10" />
    <text class="mono" x="724" y="72" style="font-size:12px;" font-family="ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial">Arena</text>
    <text class="sub muted" x="724" y="90" font-family="ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial">strings, blobs, tensor payload bytes</text>
    <path class="arrow" d="M 688 67 C 705 67, 705 67, 710 67" />
    <text class="sub muted" x="493" y="122" font-family="ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial">Envelope stores compact references; payload bytes live in the arena.</text>
    <text class="sub muted" x="493" y="142" font-family="ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial">The envelope→arena gap is optional zero padding to align arena_ofs.</text>
    <text class="sub muted" x="493" y="162" font-family="ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial">Inside the arena, each allocation is aligned independently.</text>
  </g>
  <g transform="translate(0, 330)">
    <rect class="card" x="0" y="0" width="920" height="150" rx="12" ry="12" />
    <text class="title" x="18" y="28" style="font-size:16px;" font-family="ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial">Arena allocations (illustrative)</text>
    <text class="sub muted" x="18" y="48" font-family="ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial">`arena_alloc(len, align)` may insert padding before each allocation start.</text>
    <rect class="bar" x="18" y="70" width="884" height="54" rx="12" ry="12" />
    <rect class="seg-a" x="32" y="82" width="150" height="30" rx="8" ry="8" />
    <text class="mono" x="44" y="103" style="font-size:12px;" font-family="ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial">string</text>
    <rect class="seg-p" x="190" y="82" width="70" height="30" rx="8" ry="8" />
    <text class="mono" x="200" y="103" style="font-size:12px;" font-family="ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial">pad</text>
    <rect class="seg-a" x="268" y="82" width="220" height="30" rx="8" ry="8" />
    <text class="mono" x="280" y="103" style="font-size:12px;" font-family="ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial">blob / tensor bytes</text>
    <rect class="seg-p" x="496" y="82" width="70" height="30" rx="8" ry="8" />
    <text class="mono" x="506" y="103" style="font-size:12px;" font-family="ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial">pad</text>
    <rect class="seg-a" x="574" y="82" width="170" height="30" rx="8" ry="8" />
    <text class="mono" x="586" y="103" style="font-size:12px;" font-family="ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial">string</text>
    <text class="sub muted" x="18" y="142" font-family="ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial">Padding bytes are not separately tagged; they are just zeros inserted for alignment.</text>
  </g>
</svg>